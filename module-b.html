<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module B - Data Preparation | SmartPLS Course</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
    
    <!-- SIDEBAR NAVIGATION -->
    <nav class="sidebar">
        <div class="sidebar-title">SmartPLS Masterclass</div>
        
        <div class="nav-group">
            <div class="nav-label">Phase 1: Foundations</div>
            <a href="module-a.html" class="nav-item mod-A">
                <span>A. Research Design</span>
            </a>
            <!-- Module B is Active -->
            <a href="module-b.html" class="nav-item mod-B active">
                <span>B. Data Preparation</span>
            </a>
        </div>

        <div class="nav-group">
            <div class="nav-label">Phase 2: Analysis</div>
            <a href="module-c.html" class="nav-item mod-C">
                <span>C. Measurement Model</span>
            </a>
            <a href="module-d.html" class="nav-item mod-D">
                <span>D. Structural Model</span>
            </a>
        </div>

        <div class="nav-group">
            <div class="nav-label">Phase 3: Advanced</div>
            <a href="module-e.html" class="nav-item mod-E">
                <span>E. Advanced Analysis</span>
            </a>
            <a href="module-f.html" class="nav-item mod-F">
                <span>F. Robustness</span>
            </a>
        </div>

        <div class="nav-group">
            <div class="nav-label">Phase 4: Output</div>
            <a href="module-g.html" class="nav-item mod-G">
                <span>G. Research Output</span>
            </a>
        </div>
    </nav>

    <!-- MAIN CONTENT AREA -->
    <main class="main-content">
        
        <!-- MODULE HEADER -->
        <div class="tag B">Module B</div>
        <h1>Data Preparation & Screening</h1>
        <p style="font-size: 1.1rem; color: var(--text-muted);">
            SmartPLS is powerful, but it cannot fix bad data. We perform these steps in Excel or SPSS <strong>before</strong> importing.
        </p>

        <!-- LESSON 1: DATA CODING & SCREENING -->
        <h2 style="margin-top: 3rem;">1. Data Screening & Missing Values</h2>
        <p>Raw survey data often has errors: people skipped questions, or they selected the same answer for everything (Straight-lining).</p>

        <div class="tabs-container">
            <div class="tab-header">
                <button class="tab-btn active" onclick="openTab(event, 'miss-theory', 'B')">The Logic</button>
                <button class="tab-btn" onclick="openTab(event, 'miss-action', 'B')">Handling Missing Data</button>
                <button class="tab-btn" onclick="openTab(event, 'miss-threshold', 'B')">Thresholds</button>
            </div>

            <!-- Tab: Theory -->
            <div id="miss-theory" class="tab-content active">
                <h3>Why do we screen data?</h3>
                <ul style="margin-left: 1.5rem;">
                    <li><strong>Accuracy:</strong> Outliers can skew averages (means) artificially.</li>
                    <li><strong>Power:</strong> Missing data reduces your effective sample size.</li>
                    <li><strong>Validity:</strong> If a user answers "Strongly Agree" to everything, they aren't reading (Straight-lining).</li>
                </ul>
                
                <div class="metric-card warning" style="margin-top: 1.5rem;">
                    <div>
                        <div class="metric-label">Note</div>
                        <div class="metric-desc">SmartPLS has some basic handling (Mean Replacement), but Excel/SPSS is better for deep cleaning.</div>
                    </div>
                </div>
            </div>

            <!-- Tab: Action -->
            <div id="miss-action" class="tab-content">
                <h3>How to handle Missing Data</h3>
                <p>If a respondent missed 1 or 2 questions, we can <strong>impute</strong> (fill in) the data.</p>
                
                <h4 style="margin-top: 1rem;">Method: Mean Replacement</h4>
                <p>Replace the missing value with the average of the other answers given by <em>that same person</em> for the same construct.</p>
                <div style="background: #F1F5F9; padding: 10px; border-radius: 6px; margin-top: 0.5rem; font-family: monospace;">
                    Example: User missed Question 2. Their answers for Q1, Q3, Q4 are 5, 4, 6. <br>
                    -> Average is 5. <br>
                    -> Replace missing Q2 with <strong>5</strong>.
                </div>

                <h4 style="margin-top: 1rem;">Method: Case Deletion</h4>
                <p>If a user missed an entire section, delete the whole row (the respondent).</p>
            </div>

            <!-- Tab: Thresholds -->
            <div id="miss-threshold" class="tab-content">
                <h3>The "Traffic Light" Rules</h3>
                
                <div class="metric-card success">
                    <div>
                        <div class="metric-label">Missing Data</div>
                        <div class="metric-desc">Percentage of missing values per case is acceptable.</div>
                    </div>
                    <div class="metric-val">&lt; 5%</div>
                </div>

                <div class="metric-card danger" style="margin-top: 1rem;">
                    <div>
                        <div class="metric-label">Outliers (Z-Score)</div>
                        <div class="metric-desc">If a data point is > 3.29 standard deviations from the mean, it is an outlier.</div>
                    </div>
                    <div class="metric-val">&gt; 3.29</div>
                </div>
            </div>
        </div>


        <!-- LESSON 2: SAMPLE SIZE LOGIC -->
        <h2 style="margin-top: 3rem;">2. Sample Size & Power</h2>
        <p>"How many surveys do I need?" This is the most common question. The answer depends on the complexity of your model.</p>

        <div class="tabs-container">
            <div class="tab-header">
                <button class="tab-btn active" onclick="openTab(event, 'size-rule', 'B')">10-Times Rule</button>
                <button class="tab-btn" onclick="openTab(event, 'size-power', 'B')">G*Power (Advanced)</button>
                <button class="tab-btn" onclick="openTab(event, 'size-example', 'B')">Real Example</button>
            </div>

            <!-- Tab: 10 Times Rule -->
            <div id="size-rule" class="tab-content active">
                <h3>The Rule of Thumb (Cohen & Hair)</h3>
                <p>The minimum sample size should be <strong>10 times</strong> the largest number of structural paths (arrows) pointing to any single construct in your model.</p>
                
                <div class="diagram-placeholder" style="height: 150px; background: #E0F2FE; color: #0369A1;">
                    <div style="text-align: center;">
                        <div>Construct A &rarr; <strong>Construct B</strong> &larr; Construct C</div>
                        <div style="font-size: 0.8rem;">(2 Arrows pointing to B)</div>
                        <div style="font-size: 0.8rem; margin-top: 10px;">Minimum N = 2 * 10 = <strong>20</strong></div>
                    </div>
                </div>

                <p><strong>Warning:</strong> This is the absolute <em>minimum</em>. Reviewers prefer larger samples (N > 100).</p>
            </div>

            <!-- Tab: G*Power -->
            <div id="size-power" class="tab-content">
                <h3>The Gold Standard: G*Power Analysis</h3>
                <p>The "10-times rule" is just a heuristic. For high-quality journals, use <strong>G*Power 3.1</strong> (Free Software).</p>
                
                <h4>Settings for PLS-SEM:</h4>
                <ul style="margin-left: 1.5rem;">
                    <li><strong>Test family:</strong> t tests</li>
                    <li><strong>Statistical test:</strong> Linear multiple regression: Fixed model, R² increase</li>
                    <li><strong>Type of power analysis:</strong> A priori</li>
                    <li><strong>Effect size f²:</strong> 0.15 (Medium), 0.02 (Small), 0.35 (Large)</li>
                    <li><strong>α err prob:</strong> 0.05</li>
                    <li><strong>Power (1-β err prob):</strong> 0.80</li>
                </ul>
            </div>

            <!-- Tab: Example -->
            <div id="size-example" class="tab-content">
                <h3>Scenario Calculation</h3>
                <p><strong>Your Model:</strong> You have a model where "Customer Loyalty" is predicted by 3 variables: Satisfaction, Trust, and Price.</p>
                
                <div class="metric-card success">
                    <div>
                        <div class="metric-label">10-Times Calculation</div>
                        <div class="metric-desc">Largest block of arrows pointing to Loyalty = 3 arrows.</div>
                    </div>
                    <div class="metric-val">3 x 10 = 30</div>
                </div>
                
                <p style="margin-top: 1rem;"><strong>Result:</strong> You need at least 30 people. But for a robust study, aim for 150-200.</p>
            </div>
        </div>

        <!-- LESSON 3: DATA IMPORTING -->
        <h2 style="margin-top: 3rem;">3. Importing into SmartPLS</h2>
        <p>Now that your Excel file is clean, how do we get it in?</p>
        
        <div class="tabs-container">
            <div class="tab-header">
                <button class="tab-btn active" onclick="openTab(event, 'soft-import', 'B')">Step-by-Step</button>
            </div>

            <div id="soft-import" class="tab-content active">
                <ol style="margin-left: 1.5rem; line-height: 2;">
                    <li>Open SmartPLS 4.</li>
                    <li><strong>File</strong> -> <strong>Import Data</strong> (Or right-click Project root -> Import Excel Data).</li>
                    <li>Select your cleaned Excel file.</li>
                    <li>The <strong>Import Data</strong> dialog box appears.</li>
                    <li><strong>Crucial Step:</strong> Ensure your "Observations" (Rows) are identified as <em>Cases</em> and your Columns as <em>Variables</em>.</li>
                    <li>Map your variables (Optional: You can rename indicators here).</li>
                    <li>Click <strong>Finish</strong>. Your data is now linked to the project.</li>
                </ol>
            </div>
        </div>

        <!-- END OF MODULE B CHECKPOINT -->
        <div style="margin-top: 4rem; padding: 2rem; background: #F0FDFA; border: 1px solid #99F6E4; border-radius: 12px; text-align: center;">
            <h3 style="color: #0F766E; margin-bottom: 0.5rem;">Module B Complete!</h3>
            <p style="color: #115E59;">
                Your data is clean and imported. 
                <br>Next: We assess if our survey questions are valid in <a href="module-c.html" style="text-decoration: underline; font-weight: bold;">Module C (Measurement Model)</a>.
            </p>
        </div>

    </main>
</div>

<script src="script.js"></script>
</body>
</html>
